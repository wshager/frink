{"version":3,"sources":["../src/typed.js"],"names":["check","checked","f","a","t","hasOwnProperty","__wraps","Error","TypeError","constructor","name","errorMessage","i","pos","key","noKey","io","typePart","JSON","stringify","occurrence","test","occ","err","__occurrence","any","id","many","oneOrMore","maybe","zeroOrOne","single","exactlyOne","unwrap","fn","args","s","r","sl","al","hasRestParam","o","argLengthError","ret","subscribe","unwrapMaybe","value","next","error","complete","bind","unwrapSingle","__rest_param","item","c","getStack","orig","prepareStackTrace","_","stack","captureStackTrace","def","length","st","getFunctionName","getFileName","getLineNumber","getColumnNumber","__length","array","x","map","atomic","b","isNumeric","numeric","restParams"],"mappings":"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","sourcesContent":["import { seq, isSeq, create, forEach } from \"./seq\";\r\n\r\nimport { exactlyOne, zeroOrOne, oneOrMore } from \"./seq/card\";\r\n\r\nimport { id, isUndef, isList, isMap } from \"./util\";\r\n\r\nimport { array as makeArray } from \"./array\";\r\n\r\nimport { map as makeMap } from \"./map\";\r\n\r\n// TODO make configurable\r\nconst check = true;\r\n\r\n// we know typed will take a function and test it,\r\n// so we can use the same function here to bind the subscriber\r\n// we should run two tests:\r\n// 1. the cardinality\r\n// 2. the actual type\r\n// furthermore, we should\r\n// 3. unwrap Maybe (allowing nulls or preventing type tests) and Single\r\n// 4. connect types for Flowable to subscriber\r\n\r\n// wrap card + type, if isSeq, don't perform type test, but bind to subscriber:\r\n\r\nconst checked = (f,a) => {\r\n\tconst t = f(a);\r\n\tif(typeof t == \"function\" && t.hasOwnProperty(\"__wraps\")) {\r\n\t\tif(t.__wraps !== a) throw new Error(\"unknown function found\");\r\n\t} else {\r\n\t\tif(a !== t) throw new TypeError(\"Incorrect type: expected \"+t.constructor.name+\", got \"+a.constructor.name);\r\n\t}\r\n\treturn t;\r\n};\r\n\r\n\r\nconst errorMessage = (a,name,i,pos,key) => {\r\n\tif(isUndef(a) || isUndef(name)) return \"Invalid value\\n\";\r\n\tconst noKey = isUndef(key);\r\n\tif(noKey) key = \"argument\";\r\n\tconst io = i < 0 ? \"output\" : key+\" \"+(typeof i == \"string\" ? `\"${i}\"` :  i);\r\n\tconst typePart = noKey ? `for function '${name}'\\n    at ${pos[0]} (${pos[1]}:${pos[2]}:${pos[3]})` : `found in ${name}`;\r\n\treturn \"Invalid \"+io+\" *\"+JSON.stringify(a)+\"* \"+typePart + \"\\n\";\r\n};\r\n\r\nexport const occurrence = (test,occ) => f => {\r\n\tconst t = (a,name,i,pos,key) => forEach(a,a => {\r\n\t\ttry {\r\n\t\t\treturn checked(f, test(a));\r\n\t\t} catch(err) {\r\n\t\t\tthrow new Error(errorMessage(a,name,i,pos,key)+err);\r\n\t\t}\r\n\t});\r\n\tt.__occurrence = occ;\r\n\treturn t;\r\n};\r\nexport const any = occurrence(id,1);\r\nexport const many = occurrence(oneOrMore,2);\r\nexport const maybe = occurrence(zeroOrOne,3);\r\nexport const single = occurrence(exactlyOne,4);\r\n\r\nfunction unwrap(fn,args,s,r,name,pos,sl,al,hasRestParam,i,o) {\r\n\tif(i === al) {\r\n\t\tif(hasRestParam) sl--;\r\n\t\tif(sl > i) {\r\n\t\t\tthrow argLengthError(name,sl,al,hasRestParam);\r\n\t\t}\r\n\t\tconst ret = fn();\r\n\t\treturn o ? seq(ret).subscribe(o) : ret;\r\n\t}\r\n\tconst unwrapMaybe = o => a => {\r\n\t\tlet value = null;\r\n\t\ta.subscribe({\r\n\t\t\tnext(a) {\r\n\t\t\t\tvalue = a;\r\n\t\t\t},\r\n\t\t\terror(err) {\r\n\t\t\t\to.error(err);\r\n\t\t\t},\r\n\t\t\tcomplete() {\r\n\t\t\t\tunwrap(fn.bind(null,value),args,s,r,name,pos,sl,al,hasRestParam,i+1,o);\r\n\t\t\t}\r\n\t\t});\r\n\t};\r\n\tconst unwrapSingle = o => a => a.subscribe({\r\n\t\tnext(a) {\r\n\t\t\tunwrap(fn.bind(null,a),args,s,r,name,pos,sl,al,hasRestParam,i+1,o);\r\n\t\t},\r\n\t\terror(err) {\r\n\t\t\to.error(err);\r\n\t\t}\r\n\t});\r\n\tlet f = s[i];\r\n\t// TODO check optional and adapt length\r\n\tif(isUndef(f) || f.__rest_param) {\r\n\t\t// try last\r\n\t\tif(hasRestParam) {\r\n\t\t\tf = sl > 1 ? s[sl - 2] : any(item());\r\n\t\t} else {\r\n\t\t\tthrow argLengthError(name,sl,al,hasRestParam);\r\n\t\t}\r\n\t}\r\n\tconst c = f.__occurrence;\r\n\tif(isUndef(c)) f = single(f);\r\n\tconst a = check ? f(args[i],name,i,pos) : args[i];\r\n\tif(isSeq(a)) {\r\n\t\t// when we unwrap we get back an Observable, not a function...\r\n\t\tif(c === 3) {\r\n\t\t\tif(!o) {\r\n\t\t\t\treturn create(o => {\r\n\t\t\t\t\tunwrapMaybe(o)(a);\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\treturn unwrapMaybe(o)(a);\r\n\t\t\t}\r\n\t\t} else if(c === 4) {\r\n\t\t\tif(!o) {\r\n\t\t\t\treturn create(o => {\r\n\t\t\t\t\tunwrapSingle(o)(a);\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\treturn unwrapSingle(o)(a);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\treturn unwrap(fn.bind(null,a),args,s,r,name,pos,sl,al,hasRestParam,i+1,o);\r\n}\r\n\r\n// TODO use separate cross-browser package conditionally\r\nfunction getStack(){\r\n\tvar orig = Error.prepareStackTrace;\r\n\tError.prepareStackTrace = function(_, stack) {\r\n\t\treturn stack;\r\n\t};\r\n\tvar err = new Error;\r\n\tError.captureStackTrace(err);\r\n\tvar stack = err.stack;\r\n\tError.prepareStackTrace = orig;\r\n\treturn stack;\r\n}\r\n\r\nfunction argLengthError(name,sl,al,hasRestParam) {\r\n\treturn new Error(`Invalid number of arguments for function ${name}. Expected ${hasRestParam ? \"at least\" : \"\"} ${sl} got ${al}`);\r\n}\r\n\r\nexport const def = (name,s,r,pos) => {\r\n\tconst sl = s ? s.length : -1;\r\n\tif(r) {\r\n\t\tconst c = r.__occurrence;\r\n\t\tif(isUndef(c)) r = single(r);\r\n\t}\r\n\tconst hasRestParam = sl > 0 && s[sl - 1].__rest_param;\r\n\tconst f = fn => {\r\n\t\tif(typeof fn !== \"function\") throw new TypeError(\"Invalid argument for function 'def'\\nExpected a Function, got a \"+fn.constructor.name);\r\n\t\tif(isUndef(pos)) {\r\n\t\t\tvar st = getStack()[2];\r\n\t\t\tpos = [st.getFunctionName(),st.getFileName(),st.getLineNumber(),st.getColumnNumber()];\r\n\t\t}\r\n\t\tconst f = (...args) => {\r\n\t\t\tconst al = args.length;\r\n\t\t\tconst ret = unwrap(fn,args,s,r,name,pos,sl,al,hasRestParam,0);\r\n\t\t\treturn check ? forEach(ret, a => r(a,name,-1,pos)) : ret;\r\n\t\t};\r\n\t\tf.__wraps = fn;\r\n\t\treturn f;\r\n\t};\r\n\tf.__length = hasRestParam ? -1 : sl;\r\n\treturn f;\r\n};\r\n\r\nexport const array = f => a => {\r\n\tif(!isList(a)) return makeArray();\r\n\tlet i = 0;\r\n\tfor(let x of a) {\r\n\t\tf(x,\"array\",i++,[],\"value at index\");\r\n\t}\r\n\treturn a;\r\n};\r\n\r\nexport const map = f => a => {\r\n\tif(!isMap(a)) return makeMap();\r\n\tlet i = 0;\r\n\tfor(let x of a) {\r\n\t\tf(x,\"map\",i++,[],\"value at key\");\r\n\t}\r\n\treturn a;\r\n};\r\n\r\nexport const item = () => id;\r\n\r\nexport const atomic = () => a => {\r\n\t// boolean / string / numeric\r\n\tlet t = typeof a;\r\n\tif(t === \"string\" || t === \"number\" || t === \"boolean\") return a;\r\n\tconst b = a.constructor;\r\n\treturn isNumeric(a,b) ? a : new b();\r\n};\r\n\r\nconst isNumeric = (a,b) => {\r\n\tswitch(b.name) {\r\n\tcase \"Integer\":\r\n\tcase \"Number\":\r\n\tcase \"Float\":\r\n\tcase \"Decimal\":\r\n\t\treturn true;\r\n\tdefault:\r\n\t\treturn false;\r\n\t}\r\n};\r\n\r\nexport const numeric = () => a => {\r\n\tconst b = a.constructor;\r\n\treturn isNumeric(a,b) ? a : new b();\r\n};\r\n\r\nexport const restParams = () => {\r\n\treturn {__rest_param:true};\r\n};\r\n"],"file":"typed.js"}
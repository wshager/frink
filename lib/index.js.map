{"version":3,"sources":["../src/index.js"],"names":["boundSelectStreaming","selectStreaming","bind","inode","boundChildrenStreaming","childrenStreaming","isNodeEnv","global","URL","url","require","parseString","str","cb","parser","Parser","parse","$s","s","o","err","ret","error","next","complete","doc","$file","file","toString","res","subscribe","x","docL3Streaming","docStreaming","collection","$uri","uri","forEach","iff","c","t","f","apply","_f","_t"],"mappings":"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","sourcesContent":["import { inode } from \"l3n\";\r\n\r\nimport { create, forEach, boolean } from \"./seq\";\r\n\r\nimport { zeroOrOne } from \"./seq/card\";\r\n\r\nimport { Parser } from \"./parser\";\r\n\r\nimport { parse as parseStreaming } from \"./parser-l3-stream\";\r\n\r\nimport { readdir, readFile } from \"./fs\";\r\n\r\nimport { isNodeEnv } from \"./util\";\r\n\r\nimport { toVNodeStream } from \"l3n\";\r\n\r\nimport { select as selectStreaming, children as childrenStreaming } from \"./access-streaming\";\r\n\r\nconst boundSelectStreaming = selectStreaming.bind(inode);\r\n\r\nconst boundChildrenStreaming = childrenStreaming.bind(inode);\r\n\r\nexport { boundSelectStreaming as selectStreaming, boundChildrenStreaming as childrenStreaming };\r\n\r\nif(isNodeEnv && !global.URL) {\r\n\tlet url = require(\"url\");\r\n\tglobal.URL = url.URL;\r\n}\r\n\r\nexport function parseString(str, cb) {\r\n\tvar parser = new Parser(inode);\r\n\treturn parser.parseString(str, cb);\r\n}\r\n\r\nexport function parse($s){\r\n\treturn forEach(zeroOrOne($s),s => create(o => {\r\n\t\tparseString(s,function(err,ret){\r\n\t\t\tif(err) return o.error(err);\r\n\t\t\to.next(ret);\r\n\t\t\to.complete();\r\n\t\t});\r\n\t}));\r\n}\r\n\r\nexport function doc($file){\r\n\treturn forEach(zeroOrOne($file),file => create(o => {\r\n\t\treadFile(file.toString(),(err, res) => {\r\n\t\t\tif(err) return o.error(err);\r\n\t\t\tparse(res.toString()).subscribe({\r\n\t\t\t\tnext:x => o.next(x),\r\n\t\t\t\terror: err => o.error(err),\r\n\t\t\t\tcomplete: () => o.complete()\r\n\t\t\t});\r\n\t\t});\r\n\t}));\r\n}\r\n\r\nexport function docL3Streaming($file) {\r\n\treturn forEach(zeroOrOne($file),file => parseStreaming(file.toString()));\r\n}\r\n\r\nexport function docStreaming($file) {\r\n\t// TODO streaming parsing\r\n\treturn toVNodeStream(docL3Streaming($file),2);\r\n}\r\n\r\nexport function collection($uri) {\r\n\treturn forEach(zeroOrOne($uri),uri => create(o => {\r\n\t\treaddir(uri,function(err,res){\r\n\t\t\tif(err) return o.error(err);\r\n\t\t\tres.forEach(file => {\r\n\t\t\t\tdoc(uri+\"/\"+file).subscribe({\r\n\t\t\t\t\tnext: x => o.next(x),\r\n\t\t\t\t\terror: err => o.error(err)\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t\to.complete();\r\n\t\t});\r\n\t}));\r\n}\r\n\r\nexport * from \"./qname\";\r\n\r\nexport * from \"./modify\";\r\n\r\nexport * from \"./access\";\r\n\r\n//export * from \"./l3\";\r\n\r\n//export { fromJS, toJS, iter as iterJS, toL3 as jsToL3, fromL3 as jsFromL3 } from \"./json\";\r\n\r\nexport * from \"./seq\";\r\n\r\nexport * from \"./subseq\";\r\n\r\nexport * from \"./type\";\r\n\r\nexport * from \"./string\";\r\n\r\nexport * from \"./function\";\r\n\r\nexport * from \"./op\";\r\n\r\nexport * from \"./validate\";\r\n\r\nconst iff = (c,t,f) => forEach(boolean(c),ret => ret ? t.apply() : f.apply());\r\n\r\nexport { iff as if };\r\n\r\nconst _f = () => false;\r\nconst _t = () => true;\r\n\r\nexport { _f as false, _t as true} ;\r\n"],"file":"index.js"}